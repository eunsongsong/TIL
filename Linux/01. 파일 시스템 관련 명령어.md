[TOC]

### 00. 리눅스 디렉터리 종류와 특징

| 디렉터리    | 저장 내용                                                    |
| ----------- | :----------------------------------------------------------- |
| /           | 파일 시스템이 있는 최상위 디렉터리 (루트 디렉터리)           |
| /root       | 시스템 관리자용 홈 디렉터리                                  |
| /boot       | 부트 디렉터리로 부팅 시 커널 이미지와 부팅 정보 파일 저장    |
| /proc       | 시스템 정보 디렉터리, 커널 기능을 제어하는 역할 (현재 실행되는 프로세스와 실제로 사용되는 장치, 하드웨어 정보 저장) |
| /lib        | 공유 라이브러리 디렉터리 (커널 모듈 파일들과 프로그램 실행을 지원해 주는 라이브러리 저장) |
| /bin        | 기본적인 명령어가 저장된 디렉터리 (cp, mkdir, rmdir, mv, rm, cat, ...) |
| /dev        | 시스템 디바이스 파일들을 저장하는 디렉터리 (하드디스크 장치 파일, CD-ROM 장치파일 같은 파일 저장) |
| /etc        | 시스템 환경 설정 파일 저장 디렉터리                          |
| /sbin       | 관리자용 시스템 표준 명령 및 시스템 관리와 관련된 실행 명령어 저장 |
| /usr        | 사용자 디렉터리로 사용자 데이터나 애플리케이션 저장 (리눅스의 응용 프로그램이 설치되는 디렉터리) |
| /usr/local | 사용자가 소스 컴파일하여 설치하는 프로그램을 위치시키는 디렉터리 |
| /home       | 사용자 계정 디렉터리로 계정들의 홈 디렉터리가 위치           |
| /var        | 가변 자료 저장 디렉터리로 로그 파일이나 메일 데이터 저장     |
| /tmp        | 각종 프로그램이나 프로세스 작업을 할 때 임시로 생성되는 파일 저장 |
| /mnt        | 파일 시스템을 일시적으로 마운트할 때 사용                    |
| /lost+found | 결함이 있는 파일에 대한 정보가 저장되는 디렉터리             |



### 01. 파일 시스템 관련 명령어

#### 1-1. 권한

##### 허가권 : 파일이나 디렉터리 접근권한 설정

##### 소유권 : 파일이나 디렉터리를 소유

##### 파일의 허가권/소유권 확인 : ls, ls -l

```bash
song@localhost ~ ]$ ls -l
-rwxrw-rw- 1 song song 53 2020-12-01 18:00 TEST
```

| 속성 값    | 의미                                                         |
| ---------- | ------------------------------------------------------------ |
| -rwxrw-rw- | 파일 허가권(permission),  파일 유형과 파일 접근 권한으로 구성 |
| 1          | 물리적 파일 연결 개수                                        |
| song       | 파일 소유자명(User Ownership)                                |
| song       | 파일 소유 그룹명(Group Ownership)                            |
| 53         | 파일 크기(바이트 단위)                                       |
| 2020-12-01 | 파일이 마지막으로 변경된 시간                                |
| TEST       | 파일명                                                       |

###### 허가권

```bash
-rwxrw-rw-
```

| 기호 | 권한 |
| --- | --- |
| - | 첫 번째 한 자리 : 파일 유형(- 일반 파일, d 디렉터리 파일, b(블록,디스크,/dev/sda)/c(문자)/l(기호,심볼릭링크)/p(파이프)/s(소켓) 특수 파일) |
| rwx | 다음 세 자리 :  파일을 소유한 사용자 권한(user) |
| rw- | 다음 세 자리 : 그룹에 속한 사용자 권한(group) |
| rw- | 마지막 세 자리 : 기타 사용자 권한(other) |

| 권한      | 기호 모드 | 8진수 숫자 모드 | 파일                              | 디렉터리                             |
| --------- | --------- | --------------- | --------------------------------- | ------------------------------------ |
| 읽기      | r         | 4               | 파일 내용을 볼 수 있는 권한       | 디렉터리 내부 내용을 볼 수 있는 권한 |
| 쓰기      | w         | 2               | 파일 내용 수정 권한               | 디렉터리 파일 생성/삭제 권한         |
| 실행      | x         | 1               | 실행 파일을 실행시킬 수 있는 권한 | 디렉터리 내부 접근 권한              |
| 접근 제한 | -         | 0               |                                   |                                      |



#### 1-2. 권한 관련 명령어

##### chmod (change mode)

파일/디렉터리에 접근할 수 있는 허가권을 설정하는 명령

- 권한 표시 : r, w, x, - 또는 숫자모드(4, 2, 1, 0)
- 사용자 접근 권한 지정 : u(파일 소유자), g(그룹에 속한 사용자), o(기타 사용자), a(모든 사용자)
- 설정 기호 : +(권한 부여), -(권한 회수), =(기존 권한 초기화 후 지정한 권한 설정)

| 옵션            | 내용                                                      |
| --------------- | --------------------------------------------------------- |
| -R, --recursive | 하위 디렉터리 포함 모든 디렉터리 내부 파일 접근 권한 변경 |
| -c, --changes   | 변경된 정보 출력                                          |
| -f, --silent    | 중요한 메세지 아니면 출력하지 않음                        |
| -v, --version   | 명령어의 버전 정보 출력                                   |

##### chown (change owner)

파일/디렉터리의 소유권 및 그룹 소유권을 변경하는 명령

##### chgrp (change group)

특정한 사용자가 여러 그룹에 속한 경우, 본인 소유의 파일을 본인이 속한 그룹 내에서 소유권을 변경하는 명령

##### umask

파일/디렉터리 생성 시 부여되는 기본 허가권 값을 지정하는 명령  

파일 생성 시에는 666, 디렉터리 생성 시에는 777에서 umask 값을 뺀 값을 기본 허가권으로 지정한다

| 옵션 | 내용                   |
| ---- | ---------------------- |
| -S   | umask 값을 문자로 표기 |



#### 1-3. 특수 권한

- 프로세스가 실행되는 동안 해당 프로세스의 root 권한을 임시로 가져오는 기능

- 프로세스가 사용자보다 높은 수준의 접근을 요구할 때 파일 접근 제한으로 인해 원활한 기능을 제공할 수 없기 때문에 이러한 문제점을 해결하기 위한 방법

 ##### Set-UID(4000)

- 사용자가 사용할 때만 소유자 권한으로 파일을 실행
- 프로그램을 실행하는 동안 프로세스는 파일의 소유자와 같은 권한으로 실행
- 실행 파일에 Set-UID를 설정하면 소유자 권한 부분의 `x` 자리에 소문자 `s` 로 표기되고, 정상적으로 실행
- 실행 권한이 없는 파일에 Set-UID를 설정하면 대문자 `S` 가 되고, 파일을 실행할 수 없음
- Set-UID가 설정되어 있을 때 변경된 패스워드는 /etc/shadow 에 기록 됨

##### Set-GID(2000)

- 사용자가 사용할 때만 그룹 권한으로 파일을 실행
- 프로그램을 실행하는 동안 프로세스는 파일의 그룹과 같은 권한으로 실행
- Set-GID 권한이 명시된 디렉터리에 생성되는 모든 하위 디렉터리나 파일도 Set-GID 권한을 가짐

##### Sticky-Bit(1000)

- 일반적으로 공용 디렉터리에 사용 (일반적으로 `/tmp` 에 생성)

- Sticky-Bit가 적용된 디렉터리 내에 파일을 생성하는 것은 누구나 가능하지만, 삭제는 생성자 본인과 관리자만 가능

  (공용 디렉터리라도 권한에 제약을 두어 다른 사용자들의 파일을 보호하기 위한 목적)

- Sticky-Bit를 설정하면 other 계층 권한 부분의 `x` 자리에 `t` 로 표기
- 그룹의 공유 모드로 사용한 경우에는 대문자 `T` 로, 모든 사용자가 접근 가능하면 소문자 `t` 로 표기

| 특수 권한  | 코드 | 절대값 | 설명                                 |
| ---------- | ---- | ------ | ------------------------------------ |
| Set-UID    | s    | 4000   | 프로세스 실행 당시 UID로 설정        |
| Set-GID    | s    | 2000   | 프로세스 실행 당시 GID로 설정        |
| Sticky-Bit | t    | 1000   | 실행 후에도 메모리를 점유하도록 설정 |



#### 1-4. 파일 시스템 관리

##### 리눅스 파일 시스템

- 파일 시스템이란 운영체제가 파티션이나 디스크에 __데이터를 저장하고, 읽고, 쓰고, 찾기 위해 구성하는 일련의 체계__를 의미
- 초기의 리눅스는 __minix 파일 시스템을 기반__으로 만든 __ext__ 파일 시스템을 사용
- 그 다음에는 __저널링 파일 시스템 기능__이 있는 __ext3__를 사용
- 현재 대부분의 리눅스는 __ext4__ 파일 시스템을 사용

| 파일 시스템 | 특징                                                         |
| ----------- | ------------------------------------------------------------ |
| minix       | 초기 리눅스 파일 시스템의 모태. 파티션 사이즈 64MB 제한. 주로 램 디스크나 부팅 디스크에 사용. |
| ext         | 리눅스 초기에 사용되던 파일 시스템. 2GB의 데이터와 파일명을 255자까지 지정 가능. 파일 접근에 대한 타임 스탬프, 아이노드 수정 지원 불가. |
| ext2        | 고용량 디스크 사용을 염두에 두고 설계된 파일 시스템. 쉽게 호환되며 업그레이드도 쉽게 설계되어 있음. 4TB의 디스크 256 바이트 길이의 파일 이름. 2GB의 단일 파일. ext3 이전까지 대부분의 리눅스가 채택한 파일 시스템. |
| ext3        | 리눅스의 대표적인 저널링을 지원하도록 확장된 파일 시스템. ACL(Access Control List)을 통한 접근 제어 지원. |
| ext4        | 파일에 디스크 할당 시 물리적으로 연속적인 블록을 할당. 파일 접근 속도 향상 및 단편화를 줄이도록 설계된 파일 시스템. 64비트 기억공한 제한을 없앰. 1Exabyte의 디스크 볼륨과 16Terabyte의 파일을 지원하는 등 대형 파일 시스템과 관련된 기능이 대폭 강화. |
| ReiserFS    | 독일의 한스 라이저가 개발한 저널링 파일 시스템.              |
| XFS         | SGI에서 개발한 저널링 파일 시스템.                           |
| JFS         | IBM에서 개발한 저널링 파일 시스템.                           |
| msdos       | 이름은 8자, 확장자는 3자 까지만 지원.                        |
| umsdos      | 리눅스에서 MS-DOS를 확장하여 만든 것으로 긴 파일명, UID, GID, POSIX 허가권 특수 파일 등을 지원. |
| SMB         | SMB 프로토콜을 구현한 파일 시스템. 최근에는 CIFS로 확장.     |
| NFS         | 네트워크 상 파일 시스템을 공유할 때.                         |
| isofs       | ISO 9660인 CD-ROM을 위한 파일 시스템.                        |
| proc        | 가상 파일 시스템으로 커널과 관련 데이터를 담음.              |
| sysv        | /SystemV/Cohent 파일 시스템을 리눅스에 구현한 것으로 xenixFS, SystemV/386FS, CoherentFS를 지원 |

##### mount

- 리눅스에서 보조기억장치(SSD, HDD, FDD, CD-ROM) 등을 연결해서 사용 가능하게 해주는 명령어

- 특정 옵션 없이 mount 명령을 내리면 현재 마운트된 장치나 디스크를 확인할 수 있음

| 옵션 | 내용                                                        |
| ---- | ----------------------------------------------------------- |
| -a   | /etc/fstab 에 명시된 파일 시스템을 마운트할 때 사용         |
| -t   | 파일 시스템의 유형을 지정하지 않으면 /etc/fstab 파일을 참조 |
| -o   | 추가적인 설정을 적용할 때 사용                              |

###### `-o` 의 주요 항목

| 유형              | 내용                                                         |
| ----------------- | ------------------------------------------------------------ |
| ro                | 읽기 전용(read-only)으로 마운트                              |
| rw                | 읽기/쓰기 모드로 마운트 (기본값으로 설정되어 있음)           |
| remount           | 해당 파티션을 다시 마운트, 파티션 정보를 바꾸었을 때 사용    |
| loop              | loop 디바이스로 마운트할 때 사용, CD-ROM 이미지 파일인 ISO를 마운트할 때 사용 |
| noatime           | access time을 갱신하지 않도록 할 때 사용                     |
| username=사용자명 | 사용자 계정이 필요할 때 사용                                 |
| password=암호     | 패스워드가 설정되어 있을 때 사용 (보통 username과 같이 사용) |

###### `-t` 의 주요 파일 시스템 유형

| 유형             | 내용                                                         |
| ---------------- | ------------------------------------------------------------ |
| msdos            | MS-DOS 파일 시스템인 FAT-16을 마운트                         |
| vfat             | FAT-32를 마운트 할 때 지정                                   |
| ntfs             | 윈도우 NT, 2000, XP 이후 버전에서 사용되는 파일 시스템       |
| ext2, ext3, ext4 | 리눅스 시스템을 마운트 할 때 지정                            |
| iso9660          | CD-ROM이나 DVD 마운트 할 때 지정                             |
| smbfs            | 네트워크 파일 시스템인 삼바 파일 시스템을 마운트 할 때 지정  |
| cifs             | 초기 삼바 파일 시스템인 smbfs가 확장된 파일 시스템           |
| nfs              | 네트워크 파일 시스템인 NFS로 공유된 영역을 마운트 할 때 지정 |

###### 주요 디바이스 파일명

| 항목                            | 디바이스 파일명      |
| ------------------------------- | -------------------- |
| FDD                             | /dev/fd0             |
| CD-ROM 및 DVD                   | /dev/cdrom, /dev/dvd |
| IDE HDD                         | /dev/hda1, /dev/hdb1 |
| USB Memory, SCSI HDD, S-ATA HDD | /dev/sda1, /dev/sdb1 |

> CD-ROM은 뒤에 숫자가 붙지 않는다
>
> HDD, SDD, USB는 파티션을 사용하기 때문에 숫자가 붙는다

##### umount

마운트된 파일 시스템을 해제시키는 명령

| 옵션 | 내용                                             |
| ---- | ------------------------------------------------ |
| -a   | /etc/mtab 에 명시된 파일 시스템을 호출할 때 사용 |
| -t   | 언마운트할 파일 시스템을 지정할 때 사용          |

##### eject

- CD-ROM과 같은 미디어를 꺼낼 때 사용

- eject 명령 사용시 자동으로 unmount 작업을 함

##### fdisk

- 하드디스크 초기화
- 파티션 생성

| 옵션 | 내용                                 |
| ---- | ------------------------------------ |
| -l   | 디스크 파티션 테이블 정보 출력       |
| -s   | 특정 파티션 크기 출력 (단위 : block) |
| -v   | fdisk의 버전 출력                    |

| fdisk 실행 시 주요 명령 | 내용                         |
| ----------------------- | ---------------------------- |
| p                       | 현재 디스크 정보 출력        |
| d                       | 파티션 삭제                  |
| n                       | 파티션 생성/추가             |
| t                       | 파티션 속성 변경             |
| w                       | 변경된 파티션 정보 저장 종료 |
| q                       | 저장하지 않고 종료           |

##### mkfs

- 새로운 파일 시스템을 만드는 명령으로 root만 사용 가능

- 파일 시스템 유형을 지정하지 않으면 ext2로 생성

| 옵션 | 내용                                                         |
| ---- | ------------------------------------------------------------ |
| -t   | 파일 시스템 유형 지정 옵션으로 ext3, ext4 등을 지정하지 않으면, ext2로 생성 |
| -c   | 배드 블록 체크 후 파일 시스템 구축                           |
| -v   | 결과를 상세히 출력                                           |

##### mke2fs

- ext2, ext3, ext4 파일 시스템을 만드는 명령

- 파일 시스템의 유형을 지정하지 않으면 ext2로 생성

| 옵션 | 내용                                                  |
| ---- | ----------------------------------------------------- |
| -j   | 저널링 파일 시스템인 ext3 으로 만듬                   |
| -t   | 파일 시스템 유형 지정 옵션으로 ext3, ext4 등으로 지정 |

##### fsck

- 리눅스 파일 시스템을 검사하고 수리하는 명령
- 손상된 디렉터리나 파일을 수정할 때 임시로 (lost+found) 디렉터리에서 작업을 수행 수 정상적인 복구가 되면 사라짐

| 옵션 | 내용                                              |
| ---- | ------------------------------------------------- |
| -a   | 옵션을 사용하면 오류 발견 시 자동으로 복구를 시도 |
| -A   | /etc/fstab 에 정의되어 있는 모든 파일 시스템 체크 |
| -r   | 옵션을 사용하면 복구 시도 전에 확인을 요청        |
| -v   | 버전 정보를 출력                                  |
| -V   | 디렉터리에 존재하는 모든 파일 각각의 크기         |
| -s   | 대형화 모드에서 여러 파일 시스템을 점검           |

##### e2fsck

리눅스 파일 시스템인 ext2, ext3, ext4를 검사, 수리하는 명령

##### df

디스크의 크기, 사용량, 남아있는 용량을 확인하는 명령

| 옵션 | 내용                                      |
| ---- | ----------------------------------------- |
| -h   | 용량 단위 표시 (KB, MB, GB)               |
| -k   | KB 단위를 보여줌                          |
| -m   | MB 단위를 보여줌                          |
| -T   | 파티션에 대한 파일 시스템의 유형을 보여줌 |
| -i   | 아이노드의 사용량을 보여줌                |

##### du

파일이나 디렉터리의 크기를 확인하는 명령

| 옵션 | 내용                                      |
| ---- | ----------------------------------------- |
| -h   | 용량 단위 표시 (KB, MB, GB)               |
| -b   | 바이트 단위를 보여줌                      |
| -k   | KB 단위를 보여줌                          |
| -m   | MB 단위를 보여줌                          |
| -a   | 디렉터리에 존재하는 모든 파일 각각의 크기 |
| -s   | 파일들의 전체 크기를 합한 값 (총 사용량)  |

##### /etc/fstab

부팅시에 마운트할 파티션 정보가 기록된 파일 (총 6개의 필드로 구성되어 있음)

| 필드      | 내용                                                         |
| --------- | ------------------------------------------------------------ |
| 첫 번째   | 장치명, 볼륨라벨, UUID                                       |
| 두 번째   | 마운트 될 디렉터리(포인트)                                   |
| 세 번째   | 파일 시스템의 유형                                           |
| 네 번째   | 마운트 될 때의 옵션                                          |
| 다섯 번째 | 덤프 사용 주기를 결정하는 부분으로 0이면 dump를 사용하지 않고, 1이면 매일 수행, 2이면 이틀에 한 번 수행 |
| 여섯 번째 | 부팅 시 파일 시스템 점검, fsck 명령 순서로 보통 루트 파일 시스템을 1로 설정하면 가장 먼저 점검, 다른 파일 시스템은 2로 설정하여 두 번째로 설정하고 0은 부팅 시 해당 파일을 검사하지 않음 |

###### fstab 네 번째 필드의 주요 옵션

| 옵션     | 내용                                                         |
| -------- | ------------------------------------------------------------ |
| user     | 로컬 시스템에서 일반 사용자가 마운트할 수 있는 권한을 부여   |
| usrquota | 사용자의 용량을 제한하는 Disk quota를 사용할 때 해당 영역에 설정 |
| grpquota | Disk quota를 그룹별로 사용할 때 해당 영역에 설정             |
| acl      | Access Control List를 사용                                   |
| ro       | 해당 파티션을 읽기 전용으로 설정                             |
| rw       | 해당 파티션을 읽기/쓰기 모드로 설정                          |

​                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          

#### 1-5. 디스크 쿼터 (Quota)





























